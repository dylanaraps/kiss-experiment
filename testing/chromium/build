#!/bin/sh -e

# Fix 'python2' shebangs.
sed -i '1s|python$|&2|' third_party/dom_distiller_js/protoc_plugins/*.py

# Use 'gcc' instead of 'clang'.
export CC=gcc CXX=g++

python2 tools/gn/bootstrap/bootstrap.py -s -v \
    --gn-gen-args 'target_cpu="x64" is_debug=false use_jumbo_build=true enable_nacl=false symbol_level=0 blink_symbol_level=0 enable_nacl_nonsfi=false use_gtk3=true use_gold=false treat_warnings_as_errors=false fatal_linker_warnings=false use_sysroot=false use_cups=false rtc_use_x11=true use_dbus=false safe_browsing_mode=0 use_pulseaudio=false use_use_gconf=false use_gio=false use_gnome_keyring=false use_kerberos=false'

out/Release/gn gen out/Release \
    --args='target_cpu="x64" is_debug=false use_jumbo_build=true enable_nacl=false symbol_level=0 blink_symbol_level=0 enable_nacl_nonsfi=false use_gtk3=true use_gold=false treat_warnings_as_errors=false fatal_linker_warnings=false use_sysroot=false use_cups=false rtc_use_x11=true use_dbus=false safe_browsing_mode=0 use_pulseaudio=false use_use_gconf=false use_gio=false use_gnome_keyring=false use_kerberos=false'

ninja -C out/Release chrome chromedriver
sh
